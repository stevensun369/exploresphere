<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Students Directory</title>
        <script>
            let token = localStorage.getItem("token");
            let account = JSON.parse(localStorage.getItem("account"));

            if (token == null) {
                window.location.href = "welcome.html";
            }
        </script>
        <style>
            body {
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                margin: 0;
                padding: 20px 15px 30px;
                background: linear-gradient(135deg, #f7f0ff 0%, #d4c0ff 100%);
                color: #3a0474;
                min-height: 100vh;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            header {
                background-color: #6c4fff;
                padding: 15px 20px;
                width: 80%;
                margin: auto;
                font-weight: 700;
                font-size: 1.5rem;
                color: white;
                border-radius: 10px;
                margin-bottom: 20px;
                margin-top: 10px;
                box-shadow: 0 3px 10px rgba(108, 79, 255, 0.3);

                position: absolute;
                top: 10px;
                left: 10%;
            }

            main {
                position: absolute;
                top: 120px;
            }

            header .text {
                height: 50px;
                width: 100px;
                line-height: 50px;
                float: left;
            }

            header .buttons {
                float: right;

                width: 200px;
                height: 50px;
            }

            header .buttons #profile {
                float: right;
                height: 100%;
                width: 50px;
                margin-left: 10px;
            }

            header .buttons #messages {
                float: right;
                height: 100%;
                width: 50px;
                margin-left: 10px;
            }

            header .buttons img {
                width: 30px;
                height: 30px;
                margin-top: 10px;
                margin-left: 10px;
            }

            header .buttons #profile img {
                border-radius: 100px;
                border: none;
            }

            .filters {
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
                margin-bottom: 20px;
                justify-content: center;
            }

            input {
                padding: 8px 12px;
                border-radius: 12px;
                border: 1.5px solid #bbb;
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                font-size: 1rem;
                min-width: 140px;
                outline-offset: 2px;
            }

            input:focus {
                border-color: #5a2aeb;
                box-shadow: 0 0 8px #9aa4ff88;
                outline: none;
            }

            #studentsList {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
                width: 100%;
                max-width: 1200px;
                margin: auto;
            }

            .student-card {
                background: white;
                border-radius: 14px;
                box-shadow: 0 8px 20px rgba(90, 42, 235, 0.2);
                padding: 18px 22px;
                display: flex;
                flex-direction: column;
                align-items: center;
                text-align: center;
                max-width: 300px;
            }

            .student-photo {
                width: 100px;
                height: 100px;
                border-radius: 50%;
                object-fit: cover;
                box-shadow: 0 0 6px rgba(90, 42, 235, 0.25);
                margin-bottom: 12px;
            }

            .student-name {
                font-weight: 700;
                font-size: 1.2rem;
                color: #5a2aeb;
                margin-bottom: 8px;
            }

            .student-meta {
                font-size: 0.95rem;
                color: #411aa8cc;
                margin-bottom: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
            }

            .student-meta span {
                font-size: 1.2rem;
            }

            .tags {
                margin-top: 10px;
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 8px;
            }

            .tag {
                display: inline-block;
                background: #c4b8ff;
                border-radius: 20px;
                padding: 6px 14px;
                font-size: 0.85rem;
                color: #3a0474;
            }

            footer {
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                background: rgba(128, 61, 252, 0.58);
                color: #fff;
                padding: 14px 20px;
                box-shadow: 0 -2px 6px rgba(0, 0, 0, 0.3);
                display: flex;
                flex-wrap: wrap;
                justify-content: space-between;
                align-items: center;
                font-size: 0.9rem;
                user-select: none;
                z-index: 10;
            }

            footer nav a {
                color: #cfcfff;
                margin-right: 18px;
                text-decoration: none;
            }

            footer nav a:hover,
            footer nav a:focus {
                color: white;
                text-decoration: underline;
                outline: none;
            }

            :root {
                --color-primary: #6b46c1; /* dark purple */
                --color-selected-bg: #4c1d95; /* darker purple */
                --color-selected-text: #fff;
                --color-tag-bg: #e9d8fd; /* light purple */
                --color-tag-hover-bg: #9f7aea; /* medium purple */
                --color-tag-border: #d6bcfa; /* purple border */
                --color-text: #4c1d95; /* dark purple text */
                --font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            }

            body {
                margin: 0;
                background: #fafafa;
                font-family: var(--font-family);
                display: flex;
                justify-content: center;
                align-items: flex-start;
                min-height: 100vh;
                padding: 20px;
            }

            #tag-container {
                width: 70%;
                background: white;
                border-radius: 10px;
                padding: 15px 20px;
                box-shadow: 0 8px 24px rgb(0 0 0 / 0.1);
            }

            #tag-container h2 {
                margin: 0 0 12px;
                font-weight: 600;
                color: var(--color-text);
                font-size: 1.3rem;
            }

            #tags {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
            }

            .tag {
                user-select: none;
                cursor: pointer;
                background: var(--color-tag-bg);
                border: 2px solid var(--color-tag-border);
                border-radius: 20px;
                padding: 6px 15px;
                font-size: 0.9rem;
                color: var(--color-text);
                transition:
                    background-color 0.25s,
                    color 0.25s,
                    border-color 0.25s;
                flex-shrink: 0;
            }

            .tag:hover {
                background-color: var(--color-tag-hover-bg);
                border-color: var(--color-primary);
                color: var(--color-primary);
            }

            .tag.selected {
                background-color: var(--color-selected-bg);
                border-color: var(--color-selected-bg);
                color: var(--color-selected-text);
            }

            #selected-tags-list {
                margin-top: 15px;
                font-size: 1rem;
                color: var(--color-text);
                min-height: 24px;
            }

            @media (max-width: 400px) {
                #tag-container {
                    max-width: 100%;
                    padding: 15px;
                }
            }
        </style>
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const profilepicture = document.getElementById("profile-img");
                profilepicture.src =
                    "http://localhost:8000/profilepics/" + account.id;
                const students = [
                    {
                        name: "Lena Hoffmann",
                        homeUniversity: "Freie Universit√§t Berlin",
                        destinationUniversity: "University of Barcelona",
                        semester: "fall 2025",
                        tags: ["üì∏ Photography", "‚òï Caf√© Hunting"],
                        photo: "https://randomuser.me/api/portraits/women/12.jpg",
                    },
                    {
                        name: "Tom√°≈° Nov√°k",
                        homeUniversity: "Charles University",
                        destinationUniversity: "University of Bologna",
                        semester: "spring 2026",
                        tags: ["üó∫Ô∏è Weekend Trips", "üçª Pub Nights"],
                        photo: "https://randomuser.me/api/portraits/men/34.jpg",
                    },
                    {
                        name: "Emma Dupont",
                        homeUniversity: "Universit√© Paris Cit√©",
                        destinationUniversity: "University of Amsterdam",
                        semester: "fall 2026",
                        tags: ["üéß Music Lover", "üßë‚Äçü§ù‚Äçüßë Social Butterfly"],
                        photo: "https://randomuser.me/api/portraits/women/45.jpg",
                    },
                    {
                        name: "Marco Rossi",
                        homeUniversity: "Sapienza University of Rome",
                        destinationUniversity: "Lund University",
                        semester: "fall 2025",
                        tags: ["üèÖ Sport", "üöÜ Train Adventures"],
                        photo: "https://randomuser.me/api/portraits/men/56.jpg",
                    },
                    {
                        name: "Anja Petroviƒá",
                        homeUniversity: "University of Belgrade",
                        destinationUniversity: "University of Porto",
                        semester: "spring 2026",
                        tags: ["üé® Artsy", "üßò Mindfulness"],
                        photo: "https://randomuser.me/api/portraits/women/63.jpg",
                    },
                    {
                        name: "Jakub Zieli≈Ñski",
                        homeUniversity: "University of Warsaw",
                        destinationUniversity: "KU Leuven",
                        semester: "fall 2026",
                        tags: ["üìö Bookworm", "üåø Go with the Flow"],
                        photo: "https://randomuser.me/api/portraits/men/29.jpg",
                    },
                    {
                        name: "Sophie M√ºller",
                        homeUniversity: "University of Vienna",
                        destinationUniversity: "University of Copenhagen",
                        semester: "fall 2025",
                        tags: ["üëÄ Looking to meet new people", "üï∫ Clubbing"],
                        photo: "https://randomuser.me/api/portraits/women/21.jpg",
                    },
                    {
                        name: "Daniela Almeida",
                        homeUniversity: "University of Lisbon",
                        destinationUniversity: "University of Groningen",
                        semester: "spring 2026",
                        tags: ["üì∏ Photography", "üó∫Ô∏è Weekend Trips"],
                        photo: "https://randomuser.me/api/portraits/women/32.jpg",
                    },
                    {
                        name: "Kristjan Saar",
                        homeUniversity: "University of Tartu",
                        destinationUniversity: "University of Helsinki",
                        semester: "fall 2026",
                        tags: ["üéß Music Lover", "‚òï Caf√© Hunting"],
                        photo: "https://randomuser.me/api/portraits/men/67.jpg",
                    },
                    {
                        name: "Maja Kowalczyk",
                        homeUniversity: "Jagiellonian University",
                        destinationUniversity: "University of Ljubljana",
                        semester: "fall 2025",
                        tags: ["üé® Artsy", "üßë‚Äçü§ù‚Äçüßë Social Butterfly"],
                        photo: "https://randomuser.me/api/portraits/women/14.jpg",
                    },
                ];

                const container = document.getElementById("studentsList");
                const filter = document.getElementById("filter");

                function renderStudents(list) {
                    container.innerHTML = "";
                    if (list.length === 0) {
                        container.innerHTML =
                            "<p>No students found for the selected filters.</p>";
                        return;
                    }

                    list.forEach((student) => {
                        const card = document.createElement("div");
                        card.className = "student-card";

                        card.innerHTML = `
              <img src="${student.photo}" alt="Profile photo of ${student.name}" class="student-photo" />
              <div class="student-name">${student.name}</div>
              <div class="student-meta"><span>üè†</span> ${student.homeUniversity}</div>
              <div class="student-meta"><span>üéì</span> ${student.destinationUniversity}</div>
              <div class="student-meta"><span>üìÜ</span> ${student.semester}</div>
              <div class="tags">${student.tags
                  .map((tag) => `<span class="tag">${tag}</span>`)
                  .join("")}</div>
            `;

                        container.appendChild(card);
                    });
                }

                function filterStudents() {
                    const filterVal = filter.value.toLowerCase();

                    const filtered = students.filter((s) => {
                        const matchesFilter =
                            filterVal === "" ||
                            s.homeUniversity
                                .toLowerCase()
                                .includes(filterVal) ||
                            s.destinationUniversity
                                .toLowerCase()
                                .includes(filterVal);

                        let matchesTag =
                            selectedTags.length === 0 ||
                            selectedTags.some((item) => s.tags.includes(item));

                        return matchesFilter && matchesTag;
                    });

                    renderStudents(filtered);
                }

                // Object.value(filter).forEach((input) => {
                //     input.addEventListener("input", filterStudents);
                // });

                filter.addEventListener("input", filterStudents);

                renderStudents(students);

                // Initial predefined tags
                const availableTags = [
                    "üó∫Ô∏è Weekend Trips",
                    "üï∫ Clubbing",
                    "üëÄ Looking to meet new people",
                    "üèñÔ∏è Beach Days",
                    "üöÜ Train Adventures",
                    "üçª Pub Nights",
                    "üèÖ Sport",
                    "üéß Music Lover",
                    "üì∏ Photography",
                    "üé® Artsy",
                    "üßò Mindfulness",
                    "üìö Bookworm",
                    "‚òï Caf√© Hunting",
                    "üßë‚Äçü§ù‚Äçüßë Social Butterfly",
                    "üåø Go with the Flow",
                ];

                // Selected tags array
                let selectedTags = [];

                const tagsContainer = document.getElementById("tags");
                const selectedTagsList =
                    document.getElementById("selected-tags-list");

                // Function to render the tags as selectable elements
                function renderTags() {
                    tagsContainer.innerHTML = "";
                    availableTags.forEach((tag) => {
                        const tagEl = document.createElement("div");
                        tagEl.className = "tag";
                        tagEl.setAttribute("role", "option");
                        tagEl.setAttribute("tabindex", "0");
                        tagEl.textContent = tag;

                        if (selectedTags.includes(tag)) {
                            tagEl.classList.add("selected");
                            tagEl.setAttribute("aria-selected", "true");
                        } else {
                            tagEl.setAttribute("aria-selected", "false");
                        }

                        // Toggle selection on click or keyboard (enter/space)
                        tagEl.addEventListener("click", () => {
                            toggleTag(tag);
                            console.log(selectedTags);
                            filterStudents();
                        });

                        tagsContainer.appendChild(tagEl);
                    });
                }

                // Function to toggle a tag selection
                function toggleTag(tag) {
                    const index = selectedTags.indexOf(tag);
                    if (index === -1) {
                        selectedTags.push(tag);
                    } else {
                        selectedTags.splice(index, 1);
                    }
                    renderTags();
                }
                // Initial render
                renderTags();
            });
        </script>
    </head>
    <body>
        <header>
            <div class="text">Exploresphere</div>

            <div class="buttons">
                <a href="profile.html"
                    ><div id="profile">
                        <img id="profile-img" src="" alt="" /></div
                ></a>
                <a href="messages.html"
                    ><div id="messages">
                        <img src="messages.png" alt="" /></div
                ></a>
            </div>
        </header>
        <div style="height: 100px"></div>
        <main>
            <div class="filters" role="search" aria-label="Filter students">
                <input
                    id="filter"
                    type="text"
                    placeholder="Search..."
                    aria-label="Search..."
                />
            </div>

            <div
                id="tag-container"
                role="region"
                aria-label="Selectable tags"
                style="margin: 0 auto"
            >
                <h2>Choose your tags</h2>
                <div id="tags" role="list" aria-multiselectable="true"></div>
            </div>
        </main>
        <div style="height: 350px"></div>

        <section
            id="studentsList"
            aria-live="polite"
            aria-atomic="true"
        ></section>

        <div style="height: 70px"></div>
        <footer>
            <nav aria-label="Footer navigation links">
                <a href="welcome.html">Home</a>
                <a href="help.html">Help</a>
                <a href="privacy.html">Privacy Policy</a>
                <a href="terms.html">Terms of Service</a>
            </nav>
        </footer>

        <script></script>
    </body>
</html>
